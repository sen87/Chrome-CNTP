function layout_create(){$(".l_create").prop("disabled",true);var a=parseInt($(".l_columns option:selected").val());var i=parseInt($(".l_rows option:selected").val());var c="";var h=1;for(var d=1;d<=i;d++){for(var e=1;e<=a;e++){c+='<select class="l_itemtype" id="'+h+'"><option value="1">RSS Feed</option>        <option value="2">Weather</option><option value="3">Notes</option><option value="4">Bookmarks</option></select>         <select class="l_rowspan" id="'+h+'"><option value="1">Span disabled</option>';for(var b=1;b<=(i-d);b++){c+='<option value="'+(b+1)+'">Span '+(b+1)+" Rows</option>"}c+='</select><div class="l_spacer"></div>';h++}c+="<br>"}$(".l_createbox").html('<div id="l_pop">'+c+'<hr><button class="l_cancel">Cancel</button><button class="l_save">OK</button><br><br></div>');$(".l_itemtype").change(function(){var l=$(this).prop("id");var k=$(this).val();if(k!="1"){$(".l_itemtype").each(function(m){if($(this).val()==k&&$(this).prop("id")!=l){$(this).val("1");$("#"+$(this).prop("id")+".l_rowspan").prop("disabled",false)}});$("#"+l+".l_rowspan").val("1");$("#"+l+".l_rowspan").prop("disabled",false);f($("#"+l+".l_rowspan"))}else{$("#"+$(this).prop("id")+".l_rowspan").prop("disabled",false)}var j=g();layout_preview(j)});function f(k){var j=parseInt(k.prop("id"))+a;if(k.val()=="2"){$("#l_pop #"+j).val("");$("#l_pop #"+j).prop("disabled",true);$("#l_pop #"+(j+a)).val("1");$("#l_pop #"+(j+a)).prop("disabled",false);$("#l_pop #"+(j+(a*2))).val("1");$("#l_pop #"+(j+(a*2))).prop("disabled",false)}else{if(k.val()=="3"){$("#l_pop #"+j).val("");$("#l_pop #"+j).prop("disabled",true);$("#l_pop #"+(j+a)).val("");$("#l_pop #"+(j+a)).prop("disabled",true);$("#l_pop #"+(j+(a*2))).val("1");$("#l_pop #"+(j+(a*2))).prop("disabled",false)}else{if(k.val()=="4"){$("#l_pop #"+j).val("");$("#l_pop #"+j).prop("disabled",true);$("#l_pop #"+(j+a)).val("");$("#l_pop #"+(j+a)).prop("disabled",true);$("#l_pop #"+(j+(a*2))).val("");$("#l_pop #"+(j+(a*2))).prop("disabled",true)}else{$("#l_pop #"+j).val("1");$("#l_pop #"+j).prop("disabled",false);$("#l_pop #"+(j+a)).val("1");$("#l_pop #"+(j+a)).prop("disabled",false);$("#l_pop #"+(j+(a*2))).val("1");$("#l_pop #"+(j+(a*2))).prop("disabled",false)}}}}$(".l_rowspan").change(function(){f($(this));var j=g();layout_preview(j)});$(".l_cancel").click(function(j){j.preventDefault();$("#l_pop").addClass("popkill");$(".l_create").prop("disabled",false);$(".l_layout").val("default");chrome.storage.sync.get({layout_default:"",},function(k){layout_preview(k.layout_default)})});$(".l_save").click(function(j){out=g();layout_preview(out);$(".f_entry").each(function(k){if(k<out[1]){$(this).children("input").prop("disabled",false)}else{$(this).children("input").prop("disabled",true)}});chrome.storage.sync.set({layout_custom:[out[0],out[1]],layout_custom_w:out[2],layout_custom_n:out[3],layout_custom_bm:out[4],},function(){$("#l_pop").addClass("popkill");$(".l_create").prop("disabled",false)})});function g(){var l="";var r=1;var s=0;var k=false;var m=false;var j=false;for(var o=1;o<=i;o++){if(i==3){l+='<tr style="height: calc(33.33vh - 2.2em);">'}else{l+='<tr style="height: calc(25vh - 2.2em);">'}for(var p=1;p<=a;p++){if(!$("#l_pop #"+r).prop("disabled")){l+="<td ";var q=$("#"+r+".l_rowspan option:selected").val();if(q>1){l+='rowspan="'+q+'" '}var n=$("#"+r+".l_itemtype option:selected").val();if(n==1){l+='class="feed_box"></td>';s++}else{if(n==2){l+='class="weather"><div class="head"><a href=""><h3>Weather</h3></a></div><div class="weather_frame"></div></td>';k=true}else{if(n==3){l+='class="notes"><div class="head"><h3>Notes</h3></div><label class="notes_frame"></label></td>';m=true}else{l+='class="bookmarks"><div class="head"><h3>Bookmarks</h3></div><div class="b_frame"><div class="tbl_b1"></div><div class="tbl_b2"></div></div></td>';j=true}}}}r++}l+="</tr>"}return[l,s,k,m,j]}}function layout_preview(a){$(".l_preview").html(a[0]);$(".weather").html("W");$(".notes").html("N");$(".bookmarks").html("B");$(".l_preview tr").removeAttr("style");$(".feed_box").each(function(b){$(this).html(b+1)});$(".l_feedcount").text(a[1])}function bookmarks_add(){var a=prompt("Enter the Name for the new Bookmark Category: ","name here");if(a){var b=$(".cat_remove").length+1;$(".b_cats").append('<p class="b_catcount"><b><u><label id="'+a+'">'+a+'</label></u></b><br>    Position: <select><option value="left" selected="selected">left</option><option value="right">right</option></select>    <button class="cat_remove" id="cat_remove_'+b+'">Remove Category</button><br>    <textarea class="b_cattext" rows="5"></textarea><br</p>');$("#cat_remove_"+b).click(function(){bookmarks_remove($(this))})}}function bookmarks_restore(c,b,a,e){var d='<option value="left" selected="selected">left</option><option value="right">right</option>';if(a=="right"){d='<option value="left" >left</option><option value="right" selected="selected">right</option>'}$(".b_cats").append('<p class="b_catcount"><b><u><label id="'+b+'">'+b+"</label></u></b><br>  Position: <select>"+d+'</select>  <button class="cat_remove" id="cat_remove_'+c+'">Remove Category</button><br>  <textarea class="b_cattext" rows="5">'+e+"</textarea><br</p>")}function bookmarks_remove(a){if(confirm("Do you really want to remove this category?")==true){a.closest("p").remove()}}function restore_settings(){for(var a=0;a<css_themes.length;a++){$(".t_theme").append('<option value="'+css_themes[a]+'">'+css_themes[a]+".css</option>")}chrome.storage.sync.get({version:"fresh",title:"Start ▬▬▶",pin:false,layout:"default",layout_default:layout_init,layout_custom:layout_init,css_theme:"Solid(sen).min",weather:["c",true,"1118370","http://forecast.io"],b_favicons:true,b_catlist:[["Chat","left","Telegram,https://web.telegram.org/#/im"],["CNTP","left","Options,chrome-extension://jajbaigdfabgadnbmogpoichmgogbjmo/options.html"],["Fun","left","4chan,https://www.4chan.org\n9GAG,http://9gag.com\n/R/Funny,https://www.reddit.com/r/funny/\nImgur,https://imgur.com/hot/time"],["Gaming","left","Steam,http://store.steampowered.com"],["GFX","left","deviantART,http://www.deviantart.com/?order=11\npixiv,http://www.pixiv.net/ranking.php?mode=daily\nwallhaven,http://alpha.wallhaven.cc/latest"],["Music","left","Discogs,http://www.discogs.com\nLast.FM,http://www.last.fm\nSoundCloud,https://soundcloud.com/stream"],["Search","right","DuckDuckGo,https://duckduckgo.com\nGoogle,https://www.google.com\nWikipedia,https://www.wikipedia.org"],["Service","right","anonym.to,http://anonym.to\nDNSStuff,http://www.dnsstuff.com/tools\nDown?,http://www.downforeveryoneorjustme.com\nDropbox,https://www.dropbox.com/home\nProxy,http://www.proxynova.com/proxy-server-list/\nunblock,http://unblocksit.es"],["Videos","right","AniDB,http://anidb.net\nepguides,http://epguides.com\nIMDB,http://www.imdb.com\nYouTube,https://www.youtube.com/feed/subscriptions"]],f_itemcount:"20",f_feedlist:[["DeviantArt","http://www.deviantart.com/browse/all/?order=11","http://backend.deviantart.com/rss.xml?q=boost%3Apopular+meta%3Aall+max_age%3A24h&type=deviation","m"],["Phoronix","http://www.phoronix.com","http://www.phoronix.com/rss.php","d"],["Heise","http://www.heise.de","http://www.heise.de/newsticker/heise-atom.xml","d"],["LWN","https://lwn.net","https://lwn.net/headlines/rss","d"],["Netzpolitik","https://netzpolitik.org","https://netzpolitik.org/feed","d"],["Arch Linux","https://www.archlinux.org","https://planet.archlinux.org/rss20.xml","d"],["AnandTech","http://www.anandtech.com/pipeline","http://www.anandtech.com/rss/","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"],["","","","d"]]},function(c){$(".g_title").val(c.title);$(".g_pin").prop("checked",c.pin);if(c.layout=="default"){var d=c.layout_default}else{var d=c.layout_custom;$(".l_layout").val("custom")}layout_preview(d);$(".l_feedcount").text(d[1]);$(".t_theme").val(c.css_theme);$(".w_tempunit").val(c.weather[0]);$(".w_forecast").prop("checked",c.weather[1]);$(".w_woeid").val(c.weather[2]);$(".w_link").val(c.weather[3]);$(".b_favicons").prop("checked",c.b_favicons);for(var b=0;b<c.b_catlist.length;b++){bookmarks_restore(b,c.b_catlist[b][0],c.b_catlist[b][1],c.b_catlist[b][2])}for(var e=0;e<c.b_catlist.length;e++){$("#cat_remove_"+e).click(function(){bookmarks_remove($(this))})}$(".f_itemcount").val(c.f_itemcount);$(".f_entry").each(function(f){if(f<d[1]){$(this).children("input").prop("disabled",false);$(this).children(".f_imgtype").prop("disabled",false)}if(f<c.f_feedlist.length){$(this).children(".f_name").val(c.f_feedlist[f][0]);$(this).children(".f_link").val(c.f_feedlist[f][1]);$(this).children(".f_url").val(c.f_feedlist[f][2]);$(this).children(".f_imgtype").val(c.f_feedlist[f][3])}});if(c.version=="fresh"){$(".save").trigger("click")}$(".status").text("Settings restored.");setTimeout(function(){$(".status").text("")},1200)})}function save_settings(){var f=chrome.app.getDetails().version;var q=$(".g_title").val();var b=$(".g_pin").prop("checked");var e=$(".l_layout option:selected").val();var c=$(".l_layout option:selected").attr("feeds");var r=$(".t_theme option:selected").val();var o=$(".w_tempunit").val();var a=$(".w_forecast").prop("checked");var p=$(".w_woeid").val();var k=$(".w_link").val();var n=[o,a,p,k];var i=$(".b_favicons").prop("checked");var h=[];var m=$(".b_cats .b_catcount").length;for(var j=0;j<m;j++){h[j]=[$(".b_cats label")[j].id,$(".b_cats select")[j].value,$(".b_cats textarea")[j].value]}h.sort(function(t,v){var u=String(t).toUpperCase();var s=String(v).toUpperCase();if(u>s){return 1}if(u<s){return -1}return 0});var d=$(".f_itemcount").val();var g=[];$(".f_entry").each(function(s){g[s]=[$(this).children(".f_name").val(),$(this).children(".f_link").val(),$(this).children(".f_url").val(),$(this).children(".f_imgtype").val()]});try{chrome.storage.sync.set({version:f,title:q,pin:b,layout:e,layout_default:layout_init,css_theme:r,weather:n,b_favicons:i,b_catlist:h,f_itemcount:d,f_feedlist:g},function(){$(".status").text("Settings saved.");setTimeout(function(){$(".status").text("")},1200)})}catch(l){console.log("ERROR: Something went wrong while saving the configuration!");$(".status").text("ERROR: Something went wrong while saving the configuration!")}}function clear_settings(){if(confirm("Do you really want to restore the default config?\n(All your Settings will be cleared!)")==true){chrome.storage.sync.clear(function(){});window.location.reload()}}$(document).ready(function(){restore_settings();$(".tabs .tab_general").show().siblings().hide();$(".tabs .tab-links a").on("click",function(a){var b=$(this).attr("href");$(".tabs "+b).show().siblings().hide();$(this).parent("li").addClass("active").siblings().removeClass("active");a.preventDefault()});$(".save").on("click",function(){save_settings()});$(".defaults").on("click",function(){clear_settings()});$(".l_layout").change(function(){if($(".l_layout option:selected").val()=="custom"){$(".l_createbox").html('Create a new Custom Layout: <select class="l_rows"><option value="4">4 Rows</option><option value="3">3 Rows</option></select> <select class="l_columns"><option value="5">5 Columns</option><option value="4">4 Columns</option><option value="3">3 Columns</option></select> <button class="l_create">Create</button><br><br>');$(".l_create").on("click",function(){layout_create()})}else{$(".l_createbox").html("")}chrome.storage.sync.get({layout_default:"",layout_custom:""},function(a){var b="";if($(".l_layout option:selected").val()=="custom"){layout_preview(a.layout_custom)}else{layout_preview(a.layout_default)}$(".l_feedcount").text(b);$(".f_entry").each(function(c){if(c<b){$(this).children("input").prop("disabled",false)}else{$(this).children("input").prop("disabled",true)}})})});$(".t_pop_show").on("click",function(){$(".t_pop_show").prop("disabled",true);$(".t_info").html('<div class="t_pop">You can create themes for the CNTP with pure CSS!<br>    The best way to start is to use one of the already existing themes as a template.<br><hr>    The <b>location</b> of the directory containing the themes <a class="t_link" href="#">depends on your OS</a>.<br><br>    <b>Linux:</b> ~/.config/chromium/Default/Extensions/<label class="t_id"></label>/<label class="t_version"></label>/css/themes/<br>    <b>OSX:</b> ~/Library/Application Support/Chromium/Default/Extensions/<label class="t_id"></label>/<label class="t_version"></label>/css/themes/<br>    <b>Windows:</b> C:&#92Users&#92<b>YourUser</b>&#92AppData&#92Local&#92Chromium&#92User Data&#92Default&#92Extensions&#92<label class="t_id"></label>&#92<label class="t_version"></label>&#92css&#92themes&#92<br><hr>    To make your theme available here in the settings menu, go into the <b>"js"</b> folder of the extension and open the file <b>"options.js"</b>.<br>    On the last line of this file you can find the <b>"css_themes"</b> array that contains all the theme names.    Simply add your theme to this list and save the file in the subfolder "min" as "options.min.js" and reload the settings page.<br><hr>    Have fun! :D<br>    If you created a nice theme that you would like to see included in this release drop me an email: sen@archlinux.us<br><br>    <button class="t_pop_cancel">✔</button></div>');$(".t_link").on("click",function(){window.open("http://www.chromium.org/user-experience/user-data-directory")});$(".t_id").text(chrome.runtime.id);$(".t_version").text(chrome.app.getDetails().version);$(".t_pop_cancel").click(function(a){a.preventDefault();$(".t_pop").addClass("popkill");$(".t_pop_show").prop("disabled",false)})});$(".b_addcategory").on("click",function(){bookmarks_add()});$(".f_pop_show").on("click",function(){$(".f_pop_show").prop("disabled",true);$(".f_info").html('<div class="f_pop">Most websites these days offer some kind of <a class="f_link" href="#">news feed</a>. Message boards, social networking platforms, dedicated news sites, shops... you name it!<br>    You can use these feeds to get content updates and basically build your own digital newspaper.<br><hr>    While some websites give you a direct link to an rss feed (mostly in form of the orange rss icon) many will not. Even if they support it!<br><br>    <b>So how do I find the URL to a feed?</b><br>    One way is to just google for it (yeah...) or to check the page source.<br>    To check the page source of the website in question, all you need to do is: <b> right click --> View page source</b><br>    Then search (press STRG+F) for <b>"rss"</b>, <b>"feed"</b> or <b>"xml"</b> and look or an URL.<br>    Here an example feed URL (from reddit): https://www.reddit.com/r/funny/.rss<br><hr>    <b>YouTube Channel Feed</b><br>    First you need to extract the Channel ID of the YouTube Channel you want to view from its URL.<br><br>    Example Channel: https://www.youtube.com/channel/<b>UCSfNQtA4Qd3NLMBAPp3FP5A</b><br><br>    Append this ID to the following URL: https://www.youtube.com/feeds/videos.xml?channel_id=<br>    Result: https://www.youtube.com/feeds/videos.xml?channel_id=UCSfNQtA4Qd3NLMBAPp3FP5A<br><br>    <button class="f_pop_cancel">✔</button></div>');$(".f_link").on("click",function(){window.open("http://en.wikipedia.org/wiki/Web_feed")});$(".f_pop_cancel").click(function(a){a.preventDefault();$(".f_pop").addClass("popkill");$(".f_pop_show").prop("disabled",false)})})});var layout_init=['<tr style="height: calc(33.33vh - 2.2em);"><td class="weather"><div class="head"><a href=""><h3>Weather</h3></a></div><div class="weather_frame"></div></td>  <td rowspan="3" class="feed_box"></td><td class="feed_box"></td><td class="feed_box"></td>  <td rowspan="3" class="bookmarks"><div class="head"><h3>Bookmarks</h3></div><div class="b_frame"><div class="tbl_b1"></div><div class="tbl_b2"></div></div></td></tr>  <tr style="height: calc(33.33vh - 2.2em);"><td rowspan="2" class="notes"><div class="head"><h3>Notes</h3></div><label class="notes_frame"></label></td>  <td class="feed_box"></td><td class="feed_box"></td></tr><tr style="height: calc(33.33vh - 2.2em);">><td class="feed_box"></td><td class="feed_box"></td></tr>',"7"];var css_themes=["Clean&Simple(sen).min","Coffee(sen).min","PreciousPurple(SiCKHEAD).min","Solid(sen).min","Solid_Flat(sen).min"];